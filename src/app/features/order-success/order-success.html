<div class="container mx-auto px-4 py-16 max-w-4xl">
  @if (loading()) {
    <div class="flex justify-center items-center py-16">
      <p-progressSpinner />
    </div>
  } @else if (order()) {
    <div class="text-center">
      <!-- Ícono de éxito -->
      <div
        class="inline-flex items-center justify-center w-24 h-24 rounded-full bg-green-100 mb-6"
      >
        <i class="pi pi-check-circle text-6xl text-green-500"></i>
      </div>

      <h1 class="text-3xl font-bold mb-4 text-gray-800">
        Pedido Confirmado!
      </h1>
      <p class="text-xl text-gray-600 mb-2">
        Seu pedido
        <strong class="text-blue-600">{{ order()!.orderNumber }}</strong> foi
        processado com sucesso.
      </p>
      <p class="text-gray-600 mb-8">
        Você receberá um email de confirmação em breve com os detalhes do seu
        pedido.
      </p>

      <!-- Card con detalles de la orden -->
      <p-card styleClass="text-left max-w-2xl mx-auto mb-8">
        <h2 class="text-lg font-bold mb-4">Detalhes do seu Pedido</h2>

        <!-- Items -->
        <div class="space-y-3 mb-4">
          @for (item of order()!.items; track $index) {
            <div
              class="flex justify-between items-center p-3 bg-gray-50 rounded"
            >
              <div class="flex-1">
                <p class="font-semibold">{{ item.productName }}</p>
                <p class="text-sm text-gray-600">
                  {{ item.variantSize }} • {{ item.variantColor }} • Quantidade:
                  {{ item.quantity }}
                </p>
              </div>
              <p class="font-semibold">
                R$ {{ item.subtotal | number: '1.2-2' }}
              </p>
            </div>
          }
        </div>

        <p-divider />

        <!-- Totales -->
        <div class="space-y-2 mb-4">
          <div class="flex justify-between text-gray-700">
            <span>Subtotal</span>
            <span>R$ {{ order()!.subtotal | number: '1.2-2' }}</span>
          </div>
          <div class="flex justify-between text-gray-700">
            <span>Envio</span>
            <span>R$ {{ order()!.shippingCost | number: '1.2-2' }}</span>
          </div>
          <div class="flex justify-between font-bold text-lg">
            <span>Total</span>
            <span class="text-blue-600"
              >R$ {{ order()!.total | number: '1.2-2' }}</span
            >
          </div>
        </div>

        <p-divider />

        <!-- Dirección de envío -->
        <div class="mt-4">
          <h3 class="font-semibold mb-2">Endereço de Entrega</h3>
          <p class="text-sm text-gray-700">
            {{ order()!.shippingAddress.fullName }}
          </p>
          <p class="text-sm text-gray-700">
            {{ order()!.shippingAddress.street }}
          </p>
          <p class="text-sm text-gray-700">
            {{ order()!.shippingAddress.city }},
            {{ order()!.shippingAddress.state }}
            ({{ order()!.shippingAddress.zipCode }})
          </p>
          <p class="text-sm text-gray-700">
            {{ order()!.shippingAddress.phone }}
          </p>
        </div>

        <!-- Método de pago -->
        <div class="mt-4">
          <h3 class="font-semibold mb-2">Método de Pagamento</h3>
          <p class="text-sm text-gray-700">
            {{ getPaymentMethodLabel(order()!.paymentMethod) }}
          </p>
        </div>

        <!-- Información de Mercado Pago (si existe) -->
        @if (mpReturnParams()) {
          <p-divider />
          <div class="mt-4">
            <h3 class="font-semibold mb-2">Informações de Pagamento</h3>

            @if (mpReturnParams()!.status === 'approved') {
              <div class="flex items-center gap-2 text-green-600 mb-2">
                <i class="pi pi-check-circle text-xl"></i>
                <span class="font-semibold">Pagamento Aprovado</span>
              </div>
            }

            <div class="space-y-1 text-sm text-gray-700">
              @if (mpReturnParams()!.payment_id) {
                <p>
                  <span class="font-semibold">ID do Pagamento:</span>
                  <span class="font-mono ml-2">{{ mpReturnParams()!.payment_id }}</span>
                </p>
              }
              <p>
                <span class="font-semibold">Status:</span>
                <span class="ml-2">{{ mpReturnParams()!.status }}</span>
              </p>
            </div>
          </div>
        }
      </p-card>

      <!-- Información adicional -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
        <p class="text-sm text-blue-800">
          <i class="pi pi-info-circle mr-2"></i>
          Notificaremos você quando seu pedido estiver a caminho. Você pode consultar
          o status do seu pedido a qualquer momento no seu perfil.
        </p>
      </div>

      <!-- Botones de acción -->
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <p-button
          label="Ver Meus Pedidos"
          icon="pi pi-list"
          severity="secondary"
          [outlined]="true"
          (onClick)="goToOrders()"
          size="large"
        />
        <p-button
          label="Continuar Comprando"
          icon="pi pi-shopping-bag"
          (onClick)="continueShopping()"
          size="large"
        />
      </div>
    </div>
  }
</div>
