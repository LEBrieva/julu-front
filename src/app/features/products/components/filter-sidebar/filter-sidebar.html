<div class="filter-sidebar" [formGroup]="filterForm">
  <div class="filters-container">
    @if (showAccordion()) {
      <p-accordion [multiple]="true" [value]="activeIndex()">

      <!-- Panel 1: Estilos -->
      <p-accordion-panel value="1">
        <p-accordion-header>
          <div class="flex items-center gap-2">
            <i class="pi pi-tag text-blue-600"></i>
            <span class="font-medium">Estilos</span>
          </div>
        </p-accordion-header>
        <p-accordion-content>
          <div class="filter-section">
            <div class="checkbox-group">
              @for (option of styleOptions; track option.value) {
                <div class="checkbox-item">
                  <p-checkbox
                    [value]="option.value"
                    formControlName="styles"
                    [inputId]="'style-' + option.value"
                  />
                  <label [for]="'style-' + option.value" class="checkbox-label">
                    {{ option.label }}
                  </label>
                </div>
              }
            </div>
          </div>
        </p-accordion-content>
      </p-accordion-panel>

      <!-- Panel 2: Tallas -->
      <p-accordion-panel value="2">
        <p-accordion-header>
          <div class="flex items-center gap-2">
            <i class="pi pi-th-large text-blue-600"></i>
            <span class="font-medium">Tallas</span>
          </div>
        </p-accordion-header>
        <p-accordion-content>
          <div class="filter-section">
            <div class="checkbox-group">
              @for (option of sizeOptions; track option.value) {
                <div class="checkbox-item">
                  <p-checkbox
                    [value]="option.value"
                    formControlName="sizes"
                    [inputId]="'size-' + option.value"
                  />
                  <label [for]="'size-' + option.value" class="checkbox-label">
                    {{ option.label }}
                  </label>
                </div>
              }
            </div>
          </div>
        </p-accordion-content>
      </p-accordion-panel>

      <!-- Panel 3: Colores -->
      <p-accordion-panel value="3">
        <p-accordion-header>
          <div class="flex items-center gap-2">
            <i class="pi pi-palette text-blue-600"></i>
            <span class="font-medium">Colores</span>
          </div>
        </p-accordion-header>
        <p-accordion-content>
          <div class="filter-section">
            <div class="checkbox-group">
              @for (option of colorOptions; track option.value) {
                <div class="checkbox-item">
                  <p-checkbox
                    [value]="option.value"
                    formControlName="colors"
                    [inputId]="'color-' + option.value"
                  />
                  <label [for]="'color-' + option.value" class="checkbox-label">
                    <div
                      class="w-4 h-4 rounded-full border border-gray-300 mr-2"
                      [style.background-color]="option.hex"
                    ></div>
                    {{ option.label }}
                  </label>
                </div>
              }
            </div>
          </div>
        </p-accordion-content>
      </p-accordion-panel>

      <!-- Panel 4: Rango de Precio -->
      <p-accordion-panel value="4">
        <p-accordion-header>
          <div class="flex items-center gap-2">
            <i class="pi pi-dollar text-blue-600"></i>
            <span class="font-medium">Rango de Precio</span>
          </div>
        </p-accordion-header>
        <p-accordion-content>
          <div class="filter-section">
            <div class="price-range-container">
              <p-slider
                [(ngModel)]="priceRangeValue"
                [ngModelOptions]="{standalone: true}"
                [range]="true"
                [min]="minPrice()"
                [max]="maxPrice()"
                [step]="priceStep()"
                (ngModelChange)="onPriceRangeChange($event)"
                styleClass="w-full"
              />
              <div class="price-labels">
                <span class="text-sm text-gray-600">{{ formatPrice(priceRange()[0]) }}</span>
                <span class="text-sm text-gray-600">{{ formatPrice(priceRange()[1]) }}</span>
              </div>
            </div>
          </div>
        </p-accordion-content>
      </p-accordion-panel>


    </p-accordion>
    }
  </div>

  <!-- Acciones (sticky al final) -->
  <div class="sidebar-actions">
    <p-button
      label="Aplicar Filtros"
      icon="pi pi-check"
      (onClick)="applyFilters()"
      styleClass="w-full"
      severity="primary"
    />
    <p-button
      label="Limpiar Todo"
      icon="pi pi-times"
      (onClick)="clearFilters()"
      styleClass="w-full"
      severity="secondary"
      [outlined]="true"
    />
  </div>
</div>
